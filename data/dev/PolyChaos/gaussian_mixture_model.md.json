{"attributes":{"backlinks":[],"path":"/Users/lorenz/.julia/packages/PolyChaos/THVqe/docs/src/gaussian_mixture_model.md","title":"Gaussian Mixture Models"},"tag":"document","children":[{"attributes":{},"tag":"md","children":[{"attributes":{"lang":"@setup mysetup"},"tag":"codeblock","children":["using Plots\nfunction f(x,μ,σ)\n    1/sqrt(2 *π*σ^2) * exp(-(x - μ)^2 / (2σ^2))\nend\nμ, σ = [1., 1.7], [0.2, 0.3]\nρ(x) = 0.5*f(x,μ[1],σ[1]) + 0.5*f(x,μ[2],σ[2])\nx = 0:0.01:3\nplot(x,ρ.(x))\nxlabel!(\"x\")\nylabel!(\"rho(x)\")\nusing PolyChaos\ndeg = 4\nmeas = Measure(\"my_GaussMixture\", ρ, (-Inf,Inf), false, Dict(:μ=>μ, :σ=>σ)) # build measure\nop = OrthoPoly(\"my_op\", deg, meas; Nquad = 100,Nrec = 2*deg) # construct orthogonal polynomial\nshowbasis(op, digits=2) # in case you wondered\nT2 = Tensor(2,op) # compute scalar products\nT2num_1 = [ T2.get([i,j]) for i in 0:deg, j in 0:deg]\nusing QuadGK\nT2num_2 = [quadgk(x -> evaluate(i,x,op)*evaluate(j,x,op)*ρ(x),-Inf,Inf)[1] for i in 0:deg, j in 0:deg ]\nT2num_1 - T2num_2\n"],"type":"node"},{"attributes":{},"tag":"h1","children":["Gaussian Mixture Models"],"type":"node"},{"attributes":{},"tag":"p","children":["Gaussian mixture models are popular for clustering data. Generally speaking, they are continuous random variables with a special probability density, namely"],"type":"node"},{"attributes":{},"tag":"mathblock","children":["\\rho(x) = \\sum_{i = 1}^{n} \\frac{w_i}{\\sqrt{2 \\pi \\sigma_i^2}} \\exp \\left( \\frac{(x - \\mu_i)^2}{2 \\sigma_i^2} \\right) \\quad \\text{with} \\quad \\sum_{i = 1}^n w_i = 1,"],"type":"node"},{"attributes":{},"tag":"p","children":["where the pairs of means and standard deviations ",{"attributes":{},"tag":"math","children":["(\\mu_i, \\sigma_i)"],"type":"node"},", and the weights ",{"attributes":{},"tag":"math","children":["w_i"],"type":"node"}," for all ",{"attributes":{},"tag":"math","children":["i \\in \\{ 1, \\dots, n \\}"],"type":"node"}," are given. Let's consider a simple example."],"type":"node"},{"attributes":{"lang":"@example mysetup"},"tag":"codeblock","children":["using Plots\nf(x,μ,σ) = 1 / sqrt(2*π*σ^2) * exp(-(x - μ)^2 / (2σ^2))\nμs, σs, ws = [1., 1.7], [0.2, 0.3], [0.5, 0.5]\nρ(x) = sum(w*f(x, μ, σ) for (μ, σ, w) in zip(μs, σs, ws))\nx = 0:0.01:3;\nplot(x, ρ.(x))\nxlabel!(\"x\"); ylabel!(\"rho(x)\");\n"],"type":"node"},{"attributes":{},"tag":"p","children":["This looks nice!"],"type":"node"},{"attributes":{},"tag":"p","children":["What are now the polynomials that are orthogonal relative to this specific density?"],"type":"node"},{"attributes":{"lang":"@example mysetup"},"tag":"codeblock","children":["using PolyChaos\ndeg = 4\nmeas = Measure(\"my_GaussMixture\", ρ, (-Inf,Inf), false, Dict(:μ=>μ, :σ=>σ)) # build measure\nop = OrthoPoly(\"my_op\", deg, meas; Nquad = 100, Nrec = 2*deg) # construct orthogonal polynomial\nshowbasis(op, digits=2) # in case you wondered\n"],"type":"node"},{"attributes":{},"tag":"p","children":["Let's add the quadrature rule and compute the square norms of the basis polynomials."],"type":"node"},{"attributes":{"lang":"@example mysetup"},"tag":"codeblock","children":["T2 = Tensor(2,op) # compute scalar products\n[ T2.get([i,j]) for i in 0:deg, j in 0:deg ]\n"],"type":"node"},{"attributes":{},"tag":"p","children":["Great!"],"type":"node"}],"type":"node"}],"type":"node"}