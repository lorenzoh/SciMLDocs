{"attributes":{"kind":"function","backlinks":[{"tag":"sourcefile","title":"ExponentialUtilities/src/kiops.jl","docid":"sourcefiles/ExponentialUtilities/src/kiops.jl"},{"tag":"sourcefile","title":"ExponentialUtilities/src/ExponentialUtilities.jl","docid":"sourcefiles/ExponentialUtilities/src/ExponentialUtilities.jl"}],"methods":[{"line":46,"file":"/Users/lorenz/.julia/packages/ExponentialUtilities/j8g4q/src/kiops.jl","method_id":"ExponentialUtilities.kiops_1","symbol_id":"ExponentialUtilities.kiops","filedoc":"sourcefiles/ExponentialUtilities/src/kiops.jl","signature":"kiops(tau_out, A, u; mmin, mmax, m, tol, opnorm, iop, ishermitian, task1)"}],"name":"kiops","title":"kiops","symbol_id":"ExponentialUtilities.kiops","public":true,"module_id":"ExponentialUtilities"},"tag":"documentation","children":[{"attributes":{},"tag":"md","children":[{"attributes":{"lang":""},"tag":"codeblock","children":["kiops(tstops, A, u; kwargs...) -> (w, stats)\n"],"type":"node"},{"attributes":{},"tag":"p","children":["Evaluate a linear combinaton of the ",{"attributes":{},"tag":"math","children":["φ"],"type":"node"}," functions evaluated at ",{"attributes":{},"tag":"math","children":["tA"],"type":"node"}," acting on vectors from ",{"attributes":{},"tag":"math","children":["u"],"type":"node"},", that is"],"type":"node"},{"attributes":{},"tag":"mathblock","children":["  w(i) = φ_0(t[i] A) u[:, 1] + φ_1(t[i] A) u[:, 2] + φ_2(t[i] A) u[:, 3] + ..."],"type":"node"},{"attributes":{},"tag":"p","children":["The size of the Krylov subspace is changed dynamically during the integration. The Krylov subspace is computed using the incomplete orthogonalization method."],"type":"node"},{"attributes":{},"tag":"p","children":["Arguments:"],"type":"node"},{"attributes":{},"tag":"ul","children":[{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["tstops"],"type":"node"},"     - Array of ",{"attributes":{},"tag":"code","children":["tstop"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["A"],"type":"node"},"          - the matrix argument of the ",{"attributes":{},"tag":"math","children":["φ"],"type":"node"}," functions"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["u"],"type":"node"},"          - the matrix with columns representing the vectors to be multiplied by the ",{"attributes":{},"tag":"math","children":["φ"],"type":"node"}," functions"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"p","children":["Keyword arguments:"],"type":"node"},{"attributes":{},"tag":"ul","children":[{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["tol"],"type":"node"},"        - the convergence tolerance required (default: 1e-7)"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["mmin"],"type":"node"},", ",{"attributes":{},"tag":"code","children":["mmax"],"type":"node"}," - let the Krylov size vary between mmin and mmax (default: 10, 128)"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["m"],"type":"node"},"          - an estimate of the appropriate Krylov size (default: mmin)"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["iop"],"type":"node"},"        - length of incomplete orthogonalization procedure (default: 2)"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["ishermitian"],"type":"node"}," -  whether ",{"attributes":{},"tag":"math","children":["A"],"type":"node"}," is Hermitian (default: ishermitian(A))"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["opnorm"],"type":"node"},"     -  the operator norm of ",{"attributes":{},"tag":"math","children":["A"],"type":"node"}," (default: opnorm(A, Inf))"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["task1"],"type":"node"},"      - if true, divide the result by 1/T^p"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"p","children":["Returns:"],"type":"node"},{"attributes":{},"tag":"ul","children":[{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["w"],"type":"node"},"        - the linear combination of the ",{"attributes":{},"tag":"math","children":["φ"],"type":"node"}," functions evaluated at ",{"attributes":{},"tag":"math","children":["tA"],"type":"node"}," acting on the vectors from ",{"attributes":{},"tag":"math","children":["u"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["stats[1]"],"type":"node"}," - number of substeps"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["stats[2]"],"type":"node"}," - number of rejected steps"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["stats[3]"],"type":"node"}," - number of Krylov steps"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["stats[4]"],"type":"node"}," - number of matrix exponentials"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["stats[5]"],"type":"node"}," - the Krylov size of the last substep"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["n"],"type":"node"}," is the size of the original problem ",{"attributes":{},"tag":"code","children":["p"],"type":"node"}," is the highest index of the ",{"attributes":{},"tag":"math","children":["φ"],"type":"node"}," functions"],"type":"node"},{"attributes":{},"tag":"p","children":["References:"],"type":"node"},{"attributes":{},"tag":"ul","children":[{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":["Gaudreault, S., Rainwater, G. and Tokman, M., 2018. KIOPS: A fast adaptive Krylov subspace solver for exponential integrators. Journal of Computational Physics. Based on the PHIPM and EXPMVP codes (http://www1.maths.leeds.ac.uk/~jitse/software.html). https://gitlab.com/stephane.gaudreault/kiops."],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":["Niesen, J. and Wright, W.M., 2011. A Krylov subspace method for option pricing. SSRN 1799124"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":["Niesen, J. and Wright, W.M., 2012. Algorithm 919: A Krylov subspace algorithm for evaluating the ",{"attributes":{},"tag":"math","children":["φ"],"type":"node"},"-functions appearing in exponential integrators. ACM Transactions on Mathematical Software (TOMS), 38(3), p.22"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}