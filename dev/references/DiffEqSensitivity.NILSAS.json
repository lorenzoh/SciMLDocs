{"attributes":{"kind":"struct","backlinks":[{"tag":"sourcefile","title":"DiffEqSensitivity/src/nilsas.jl","docid":"sourcefiles/DiffEqSensitivity/src/nilsas.jl"},{"tag":"sourcefile","title":"DiffEqSensitivity/src/concrete_solve.jl","docid":"sourcefiles/DiffEqSensitivity/src/concrete_solve.jl"},{"tag":"sourcefile","title":"DiffEqSensitivity/src/DiffEqSensitivity.jl","docid":"sourcefiles/DiffEqSensitivity/src/DiffEqSensitivity.jl"},{"tag":"sourcefile","title":"DiffEqSensitivity/src/sensitivity_algorithms.jl","docid":"sourcefiles/DiffEqSensitivity/src/sensitivity_algorithms.jl"}],"methods":[{"line":850,"file":"/Users/lorenz/.julia/packages/DiffEqSensitivity/GjhZ8/src/sensitivity_algorithms.jl","method_id":"DiffEqSensitivity.NILSAS_1","symbol_id":"DiffEqSensitivity.NILSAS","filedoc":"sourcefiles/DiffEqSensitivity/src/sensitivity_algorithms.jl","signature":"DiffEqSensitivity.NILSAS(nseg, nstep)"},{"line":850,"file":"/Users/lorenz/.julia/packages/DiffEqSensitivity/GjhZ8/src/sensitivity_algorithms.jl","method_id":"DiffEqSensitivity.NILSAS_2","symbol_id":"DiffEqSensitivity.NILSAS","filedoc":"sourcefiles/DiffEqSensitivity/src/sensitivity_algorithms.jl","signature":"DiffEqSensitivity.NILSAS(nseg, nstep, M; rng, adjoint_sensealg, chunk_size, autodiff, diff_type, autojacvec, g)"}],"name":"NILSAS","title":"NILSAS","symbol_id":"DiffEqSensitivity.NILSAS","public":true,"module_id":"DiffEqSensitivity"},"tag":"documentation","children":[{"attributes":{},"tag":"md","children":[{"attributes":{},"tag":"p","children":["NILSAS <: AbstractShadowingSensitivityAlgorithm"],"type":"node"},{"attributes":{},"tag":"p","children":["An implementation of the adjoint-mode, continuous ",{"attributes":{"href":"https://arxiv.org/abs/1801.08674","title":""},"tag":"a","children":["non-intrusive adjoint least squares shadowing"],"type":"node"}," method. ",{"attributes":{},"tag":"code","children":["NILSAS"],"type":"node"}," allows for computing sensitivities of long-time averaged quantities with respect to the parameters of an ",{"attributes":{},"tag":"code","children":["ODEProblem"],"type":"node"}," by constraining the computation to the unstable subspace. ",{"attributes":{},"tag":"code","children":["NILSAS"],"type":"node"}," employs SciMLSensitivity.jl's continuous adjoint sensitivity methods on each segment to compute (homogenous and inhomogenous) adjoint solutions. To avoid an exponential blow-up of the adjoint solutions, the trajectory should be divided into sufficiently small segments, where the adjoint solutions are rescaled on the interfaces. The computational and memory cost of NILSAS scale with the number of unstable, adjoint Lyapunov exponents (instead of the number of states as in the LSS method). ",{"attributes":{},"tag":"code","children":["NILSAS"],"type":"node"}," avoids the explicit construction of the Jacobian at each time step and thus should generally be preferred (for large system sizes) over ",{"attributes":{},"tag":"code","children":["AdjointLSS"],"type":"node"},". ",{"attributes":{},"tag":"code","children":["NILSAS"],"type":"node"}," is favourable over ",{"attributes":{},"tag":"code","children":["NILSS"],"type":"node"}," for many parameters because NILSAS computes the gradient with respect to multiple parameters with negligible additional cost."],"type":"node"},{"attributes":{},"tag":"h2","children":["Constructor"],"type":"node"},{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"CALL","children":[{"attributes":{"reftype":"symbol","document_id":"references/DiffEqSensitivity.NILSAS"},"tag":"reference","children":["NILSAS"],"type":"node"},{"attributes":{},"tag":"LPAREN","children":["("],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["nseg"],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["nstep"],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"KW","children":[{"attributes":{},"tag":"IDENTIFIER","children":["M"],"type":"node"},{"attributes":{},"tag":"EQ","children":["="],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["nothing"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"PARAMETERS","children":[{"attributes":{},"tag":"SEMICOLON","children":[";"],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"KW","children":[{"attributes":{},"tag":"IDENTIFIER","children":["rng"],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"EQ","children":["="],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"CALL","children":[{"attributes":{},"tag":"DOT","children":[{"attributes":{},"tag":"IDENTIFIER","children":["Xorshifts"],"type":"node"},{"attributes":{},"tag":"DOT","children":["."],"type":"node"},{"attributes":{},"tag":"QUOTE","children":[{"attributes":{},"tag":"IDENTIFIER","children":["Xoroshiro128Plus"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"LPAREN","children":["("],"type":"node"},{"attributes":{},"tag":"CALL","children":[{"attributes":{},"tag":"IDENTIFIER","children":["rand"],"type":"node"},{"attributes":{},"tag":"LPAREN","children":["("],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["UInt64"],"type":"node"},{"attributes":{},"tag":"RPAREN","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"RPAREN","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"NEWLINE_WS","children":["\n                                "],"type":"node"},{"attributes":{},"tag":"KW","children":[{"attributes":{},"tag":"IDENTIFIER","children":["adjoint_sensealg"],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"EQ","children":["="],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"CALL","children":[{"attributes":{"reftype":"symbol","document_id":"references/DiffEqSensitivity.BacksolveAdjoint"},"tag":"reference","children":["BacksolveAdjoint"],"type":"node"},{"attributes":{},"tag":"LPAREN","children":["("],"type":"node"},{"attributes":{},"tag":"RPAREN","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"NEWLINE_WS","children":["\n                                "],"type":"node"},{"attributes":{},"tag":"KW","children":[{"attributes":{},"tag":"IDENTIFIER","children":["chunk_size"],"type":"node"},{"attributes":{},"tag":"EQ","children":["="],"type":"node"},{"attributes":{},"tag":"INTEGER","children":["0"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"KW","children":[{"attributes":{},"tag":"IDENTIFIER","children":["autodiff"],"type":"node"},{"attributes":{},"tag":"EQ","children":["="],"type":"node"},{"attributes":{},"tag":"TRUE","children":["true"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"NEWLINE_WS","children":["\n                                "],"type":"node"},{"attributes":{},"tag":"KW","children":[{"attributes":{"reftype":"symbol","document_id":"references/DiffEqSensitivity.diff_type"},"tag":"reference","children":["diff_type"],"type":"node"},{"attributes":{},"tag":"EQ","children":["="],"type":"node"},{"attributes":{},"tag":"CURLY","children":[{"attributes":{},"tag":"IDENTIFIER","children":["Val"],"type":"node"},{"attributes":{},"tag":"LBRACE","children":["{"],"type":"node"},{"attributes":{},"tag":"QUOTE","children":[{"attributes":{},"tag":"COLON","children":[":"],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["central"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"RBRACE","children":["}"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"NEWLINE_WS","children":["\n                                "],"type":"node"},{"attributes":{},"tag":"KW","children":[{"attributes":{},"tag":"IDENTIFIER","children":["autojacvec"],"type":"node"},{"attributes":{},"tag":"EQ","children":["="],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["autodiff"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"NEWLINE_WS","children":["\n                                "],"type":"node"},{"attributes":{},"tag":"KW","children":[{"attributes":{},"tag":"IDENTIFIER","children":["g"],"type":"node"},{"attributes":{},"tag":"EQ","children":["="],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["nothing"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NEWLINE_WS","children":["\n                                "],"type":"node"},{"attributes":{},"tag":"RPAREN","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"h2","children":["Arguments"],"type":"node"},{"attributes":{},"tag":"ul","children":[{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["nseg"],"type":"node"},": Number of segments on full time interval on the attractor."],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["nstep"],"type":"node"},": number of steps on each segment."],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["M"],"type":"node"},": number of homogenous adjoint solutions. This number must be bigger or equal than the number of (positive, adjoint) Lyapunov exponents. Default is ",{"attributes":{},"tag":"code","children":["nothing"],"type":"node"},"."],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"h2","children":["Keyword Arguments"],"type":"node"},{"attributes":{},"tag":"ul","children":[{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["rng"],"type":"node"},": (Pseudo) random number generator. Used for initializing the terminate conditions of the homogenous adjoint states (",{"attributes":{},"tag":"code","children":["w"],"type":"node"},"). Default is ",{"attributes":{},"tag":"code","children":["Xorshifts.Xoroshiro128Plus(rand(UInt64))"],"type":"node"},"."],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["adjoint_sensealg"],"type":"node"},": Continuous adjoint sensitivity method to compute homogenous and inhomogenous adjoint solutions on each segment. Default is ",{"attributes":{},"tag":"code","children":["BacksolveAdjoint()"],"type":"node"},"."],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["autodiff"],"type":"node"},": Use automatic differentiation for constructing the Jacobian if the Jacobian needs to be constructed.  Defaults to ",{"attributes":{},"tag":"code","children":["true"],"type":"node"},"."],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["chunk_size"],"type":"node"},": Chunk size for forward-mode differentiation if full Jacobians are built (",{"attributes":{},"tag":"code","children":["autojacvec=false"],"type":"node"}," and ",{"attributes":{},"tag":"code","children":["autodiff=true"],"type":"node"},"). Default is ",{"attributes":{},"tag":"code","children":["0"],"type":"node"}," for automatic choice of chunk size."],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["diff_type"],"type":"node"},": The method used by FiniteDiff.jl for constructing the Jacobian if the full Jacobian is required with ",{"attributes":{},"tag":"code","children":["autodiff=false"],"type":"node"},"."],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["autojacvec"],"type":"node"},": Calculate the vector-Jacobian product (",{"attributes":{},"tag":"code","children":["J'*v"],"type":"node"},") via automatic differentiation with special seeding. The default is ",{"attributes":{},"tag":"code","children":["true"],"type":"node"},". The total set of choices are:"],"type":"node"},{"attributes":{},"tag":"ul","children":[{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["false"],"type":"node"},": the Jacobian is constructed via FiniteDiff.jl"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["true"],"type":"node"},": the Jacobian is constructed via ForwardDiff.jl"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["TrackerVJP"],"type":"node"},": Uses Tracker.jl for the vjp."],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["ZygoteVJP"],"type":"node"},": Uses Zygote.jl for the vjp."],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["EnzymeVJP"],"type":"node"},": Uses Enzyme.jl for the vjp."],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["ReverseDiffVJP(compile=false)"],"type":"node"},": Uses ReverseDiff.jl for the vjp. ",{"attributes":{},"tag":"code","children":["compile"],"type":"node"}," is a boolean for whether to precompile the tape, which should only be done if there are no branches (",{"attributes":{},"tag":"code","children":["if"],"type":"node"}," or ",{"attributes":{},"tag":"code","children":["while"],"type":"node"}," statements) in the ",{"attributes":{},"tag":"code","children":["f"],"type":"node"}," function."],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["g"],"type":"node"},": instantaneous objective function of the long-time averaged objective."],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"h2","children":["SciMLProblem Support"],"type":"node"},{"attributes":{},"tag":"p","children":["This ",{"attributes":{},"tag":"code","children":["sensealg"],"type":"node"}," only supports ",{"attributes":{},"tag":"code","children":["ODEProblem"],"type":"node"},"s. This ",{"attributes":{},"tag":"code","children":["sensealg"],"type":"node"}," does not support events (callbacks). This ",{"attributes":{},"tag":"code","children":["sensealg"],"type":"node"}," assumes that the objective is a long-time averaged quantity and ergodic, i.e. the time evolution of the system behaves qualitatively the same over infinite time independent of the specified initial conditions, such that only the sensitivity with respect to the parameters is of interest."],"type":"node"},{"attributes":{},"tag":"h2","children":["References"],"type":"node"},{"attributes":{},"tag":"p","children":["Ni, A., and Talnikar, C., Adjoint sensitivity analysis on chaotic dynamical systems by Non-Intrusive Least Squares Adjoint Shadowing (NILSAS). Journal of Computational Physics 395, 690-709 (2019)."],"type":"node"}],"type":"node"}],"type":"node"}