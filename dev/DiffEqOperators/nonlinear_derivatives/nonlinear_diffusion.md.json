{"attributes":{"backlinks":[],"path":"/Users/lorenz/.julia/packages/DiffEqOperators/NWEwW/docs/src/nonlinear_derivatives/nonlinear_diffusion.md","title":"Nonlinear Diffusion"},"tag":"document","children":[{"attributes":{},"tag":"md","children":[{"attributes":{},"tag":"h1","children":["Nonlinear Diffusion"],"type":"node"},{"attributes":{},"tag":"p","children":["This function handles expressions of the form ",{"attributes":{},"tag":"code","children":["ðₙ(D(ðₘu))"],"type":"node"}," where ",{"attributes":{},"tag":"code","children":["n,m > 0"],"type":"node"}," and ",{"attributes":{},"tag":"code","children":["D"],"type":"node"}," is a function of ",{"attributes":{},"tag":"code","children":["u"],"type":"node"}," i.e. they vary as ",{"attributes":{},"tag":"code","children":["u(x,t)"],"type":"node"}," and ",{"attributes":{},"tag":"code","children":["D(u)"],"type":"node"},". The expansion can be carried out via ",{"attributes":{"href":"https://en.wikipedia.org/wiki/General_Leibniz_rule","title":""},"tag":"a","children":["general Leibniz rule"],"type":"node"},"."],"type":"node"},{"attributes":{},"tag":"p","children":["A boundary condition operator ",{"attributes":{},"tag":"code","children":["bc"],"type":"node"}," is first operated on ",{"attributes":{},"tag":"code","children":["u"],"type":"node"}," resulting in a boundary padded vector ",{"attributes":{},"tag":"code","children":["bc*u"],"type":"node"},". Since ",{"attributes":{},"tag":"code","children":["D"],"type":"node"}," is a function of ",{"attributes":{},"tag":"code","children":["u"],"type":"node"},", its discrete values can be obtained at grid points once ",{"attributes":{},"tag":"code","children":["u"],"type":"node"}," has been padded.  After producing these two functions in the grid range, we can expand the given expression via binomial expansion through the ",{"attributes":{},"tag":"code","children":["nonlinear_diffusion"],"type":"node"}," and ",{"attributes":{},"tag":"code","children":["nonlinear_diffusion!"],"type":"node"}," functions and produce the final discretized derivatives."],"type":"node"},{"attributes":{},"tag":"p","children":[{"attributes":{"src":"https://github.com/SciML/DiffEqOperators.jl/raw/master/binomial_expansion.svg","alt":""},"tag":"img","children":["Expressions for general Leibnuz rule with varying m"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"p","children":["The functions implicitly put the ",{"attributes":{},"tag":"code","children":["CenteredDifference"],"type":"node"}," operator to use for computing derivates of various orders, e.g. ",{"attributes":{},"tag":"code","children":["uᵏ = CenteredDifference(k,approx_order,dx,nknots)*u"],"type":"node"},", helping us generate a symmetric discretization. The two functions differ in terms of memory allocation, since the non-",{"attributes":{},"tag":"code","children":["!"],"type":"node"}," one will allocate memory to the output whereas the ",{"attributes":{},"tag":"code","children":["!"],"type":"node"}," one can be used for non-allocating applications."],"type":"node"},{"attributes":{},"tag":"h2","children":["Functions"],"type":"node"},{"attributes":{},"tag":"p","children":["The two functions are as follows :"],"type":"node"},{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"WHERE","children":[{"attributes":{},"tag":"CALL","children":[{"attributes":{"reftype":"symbol","document_id":"references/DiffEqOperators.nonlinear_diffusion"},"tag":"reference","children":["nonlinear_diffusion"],"type":"node"},{"attributes":{},"tag":"LPAREN","children":["("],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":[{"attributes":{},"tag":"IDENTIFIER","children":["second_differential_order"],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":["::"],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["Int"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":[{"attributes":{},"tag":"IDENTIFIER","children":["first_differential_order"],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":["::"],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["Int"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":[{"attributes":{},"tag":"IDENTIFIER","children":["approx_order"],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":["::"],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["Int"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"NEWLINE_WS","children":["\n                    "],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":[{"attributes":{},"tag":"IDENTIFIER","children":["p"],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":["::"],"type":"node"},{"attributes":{},"tag":"CURLY","children":[{"attributes":{},"tag":"IDENTIFIER","children":["AbstractVector"],"type":"node"},{"attributes":{},"tag":"LBRACE","children":["{"],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["T"],"type":"node"},{"attributes":{},"tag":"RBRACE","children":["}"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":[{"attributes":{},"tag":"IDENTIFIER","children":["q"],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":["::"],"type":"node"},{"attributes":{},"tag":"CURLY","children":[{"attributes":{},"tag":"IDENTIFIER","children":["AbstractVector"],"type":"node"},{"attributes":{},"tag":"LBRACE","children":["{"],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["T"],"type":"node"},{"attributes":{},"tag":"RBRACE","children":["}"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":[{"attributes":{},"tag":"IDENTIFIER","children":["dx"],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":["::"],"type":"node"},{"attributes":{},"tag":"CURLY","children":[{"attributes":{},"tag":"IDENTIFIER","children":["Union"],"type":"node"},{"attributes":{},"tag":"LBRACE","children":["{"],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["T"],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"CURLY","children":[{"attributes":{},"tag":"IDENTIFIER","children":["AbstractVector"],"type":"node"},{"attributes":{},"tag":"LBRACE","children":["{"],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["T"],"type":"node"},{"attributes":{},"tag":"RBRACE","children":["}"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["Real"],"type":"node"},{"attributes":{},"tag":"RBRACE","children":["}"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"NEWLINE_WS","children":["\n                    "],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":[{"attributes":{},"tag":"IDENTIFIER","children":["nknots"],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":["::"],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["Int"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"RPAREN","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"WHERE","children":["where"],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"LBRACE","children":["{"],"type":"node"},{"attributes":{},"tag":"ISSUBTYPE","children":[{"attributes":{},"tag":"IDENTIFIER","children":["T"],"type":"node"},{"attributes":{},"tag":"ISSUBTYPE","children":["<:"],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["Real"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["N"],"type":"node"},{"attributes":{},"tag":"RBRACE","children":["}"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NEWLINE_WS","children":["\n"],"type":"node"},{"attributes":{},"tag":"NEWLINE_WS","children":["\n"],"type":"node"},{"attributes":{},"tag":"WHERE","children":[{"attributes":{},"tag":"CALL","children":[{"attributes":{"reftype":"symbol","document_id":"references/DiffEqOperators.nonlinear_diffusion!"},"tag":"reference","children":["nonlinear_diffusion!"],"type":"node"},{"attributes":{},"tag":"LPAREN","children":["("],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":[{"attributes":{},"tag":"IDENTIFIER","children":["du"],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":["::"],"type":"node"},{"attributes":{},"tag":"CURLY","children":[{"attributes":{},"tag":"IDENTIFIER","children":["AbstractVector"],"type":"node"},{"attributes":{},"tag":"LBRACE","children":["{"],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["T"],"type":"node"},{"attributes":{},"tag":"RBRACE","children":["}"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":[{"attributes":{},"tag":"IDENTIFIER","children":["second_differential_order"],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":["::"],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["Int"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":[{"attributes":{},"tag":"IDENTIFIER","children":["first_differential_order"],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":["::"],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["Int"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"NEWLINE_WS","children":["\n                     "],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":[{"attributes":{},"tag":"IDENTIFIER","children":["approx_order"],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":["::"],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["Int"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":[{"attributes":{},"tag":"IDENTIFIER","children":["p"],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":["::"],"type":"node"},{"attributes":{},"tag":"CURLY","children":[{"attributes":{},"tag":"IDENTIFIER","children":["AbstractVector"],"type":"node"},{"attributes":{},"tag":"LBRACE","children":["{"],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["T"],"type":"node"},{"attributes":{},"tag":"RBRACE","children":["}"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":[{"attributes":{},"tag":"IDENTIFIER","children":["q"],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":["::"],"type":"node"},{"attributes":{},"tag":"CURLY","children":[{"attributes":{},"tag":"IDENTIFIER","children":["AbstractVector"],"type":"node"},{"attributes":{},"tag":"LBRACE","children":["{"],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["T"],"type":"node"},{"attributes":{},"tag":"RBRACE","children":["}"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"NEWLINE_WS","children":["\n                     "],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":[{"attributes":{},"tag":"IDENTIFIER","children":["dx"],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":["::"],"type":"node"},{"attributes":{},"tag":"CURLY","children":[{"attributes":{},"tag":"IDENTIFIER","children":["Union"],"type":"node"},{"attributes":{},"tag":"LBRACE","children":["{"],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["T"],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"CURLY","children":[{"attributes":{},"tag":"IDENTIFIER","children":["AbstractVector"],"type":"node"},{"attributes":{},"tag":"LBRACE","children":["{"],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["T"],"type":"node"},{"attributes":{},"tag":"RBRACE","children":["}"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["Real"],"type":"node"},{"attributes":{},"tag":"RBRACE","children":["}"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":[{"attributes":{},"tag":"IDENTIFIER","children":["nknots"],"type":"node"},{"attributes":{},"tag":"DECLARATION","children":["::"],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["Int"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"RPAREN","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"WHERE","children":["where"],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"LBRACE","children":["{"],"type":"node"},{"attributes":{},"tag":"ISSUBTYPE","children":[{"attributes":{},"tag":"IDENTIFIER","children":["T"],"type":"node"},{"attributes":{},"tag":"ISSUBTYPE","children":["<:"],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["Real"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"COMMA","children":[","],"type":"node"},{"attributes":{},"tag":"WHITESPACE","children":[" "],"type":"node"},{"attributes":{},"tag":"IDENTIFIER","children":["N"],"type":"node"},{"attributes":{},"tag":"RBRACE","children":["}"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"p","children":["Arguments :"],"type":"node"},{"attributes":{},"tag":"ul","children":[{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["du"],"type":"node"}," : an input ",{"attributes":{},"tag":"code","children":["AbstractVector"],"type":"node"}," similar to ",{"attributes":{},"tag":"code","children":["u"],"type":"node"},", to store the final discretized expression."],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["second_differential_order"],"type":"node"}," : the overall order of derivative on the expression.",{"attributes":{},"tag":"code","children":["(n)"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["first_differential_order"],"type":"node"}," : the inner order of derivative to discretize for ",{"attributes":{},"tag":"code","children":["u"],"type":"node"},".",{"attributes":{},"tag":"code","children":["(m)"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["approx_order"],"type":"node"}," : the order of the discretization in terms of O(dx^order)."],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["p"],"type":"node"}," : boundary padded ",{"attributes":{},"tag":"code","children":["D"],"type":"node"},"."],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["q"],"type":"node"}," : boundary padded ",{"attributes":{},"tag":"code","children":["u"],"type":"node"}," obtained by ",{"attributes":{},"tag":"code","children":["bc*u"],"type":"node"},"."],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["dx"],"type":"node"},": spacing of the discretization. If ",{"attributes":{},"tag":"code","children":["dx"],"type":"node"}," is a ",{"attributes":{},"tag":"code","children":["Number"],"type":"node"},", the discretization is uniform. If ",{"attributes":{},"tag":"code","children":["dx"],"type":"node"}," is an array, then the discretization is non-uniform."],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":["nknots"],"type":"node"}," : the length of discretization in the direction of operator."],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}