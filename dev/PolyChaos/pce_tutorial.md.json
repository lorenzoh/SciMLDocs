{"attributes":{"backlinks":[],"path":"/Users/lorenz/.julia/packages/PolyChaos/THVqe/docs/src/pce_tutorial.md","title":"[Common Random Variables]( CommonRandomVariables)"},"tag":"document","children":[{"attributes":{},"tag":"md","children":[{"attributes":{"lang":"@setup mysetup"},"tag":"codeblock","children":["using PolyChaos\nd = 6\nmyops = Dict()\npolynames = [\"gaussian\", \"beta01\", \"uniform01\", \"logistic\"]\ngaussian = GaussOrthoPoly(d);\nmyops[\"gaussian\"] = gaussian\nα, β = 1.3, 2.2\nbeta01 = Beta01OrthoPoly(d,α,β);\nmyops[\"beta01\"] = beta01\nuniform01 = Uniform01OrthoPoly(d);\nmyops[\"uniform01\"] = uniform01\nlogistic = LogisticOrthoPoly(d);\nmyops[\"logistic\"] = logistic;\nmyops\npoints, degrees = randn(10), 0:2:d\n[ evaluate(degree,points,gaussian) for degree in degrees ]\nμ, σ = 2., 0.2\npce_gaussian = convert2affinePCE(μ,σ,gaussian)\na, b = -0.3, 1.2\nconvert2affinePCE(a,b,uniform01)\npce_uniform = convert2affinePCE(μ,σ,uniform01;kind=\"μσ\")\nconvert2affinePCE(a,b,beta01)\npce_beta = convert2affinePCE(μ,σ,beta01; kind=\"μσ\")\na1, a2 = μ, sqrt(3)*σ/pi\npce_logistic = convert2affinePCE(a1,a2,logistic)\nmean(pce_gaussian,myops[\"gaussian\"]), std(pce_gaussian,myops[\"gaussian\"])\nmean(pce_uniform,myops[\"uniform01\"]), std(pce_uniform,myops[\"uniform01\"])\nmean(pce_beta,myops[\"beta01\"]), std(pce_beta,myops[\"beta01\"])\nmean(pce_logistic,myops[\"logistic\"]), std(pce_logistic,myops[\"logistic\"])\nusing Statistics\nN = 1000\nξ_gaussian = sampleMeasure(N,myops[\"gaussian\"])\nsamples_gaussian = evaluatePCE(pce_gaussian,ξ_gaussian,myops[\"gaussian\"])\nξ_uniform = sampleMeasure(N,myops[\"uniform01\"])\nsamples_uniform = evaluatePCE(pce_uniform,ξ_uniform,myops[\"uniform01\"])\nξ_beta = sampleMeasure(N,myops[\"beta01\"])\nsamples_beta = evaluatePCE(pce_beta,ξ_beta,myops[\"beta01\"])\nξ_logistic = sampleMeasure(N,myops[\"logistic\"])\nsamples_logistic = evaluatePCE(pce_logistic,ξ_logistic,myops[\"logistic\"])\n\n"],"type":"node"},{"attributes":{},"tag":"h1","children":["[Common Random Variables](",{"attributes":{},"tag":"citation","children":[{"mimes":{"text/plain":"Any[]"},"type":"leaf"},{"mimes":{"text/plain":"Dict{Symbol, String}()"},"type":"leaf"}],"type":"node"}," CommonRandomVariables)"],"type":"node"},{"attributes":{},"tag":"p","children":["Polynomial chaos expansion (PCE) is a Hilbert space technique for random variables with finite variance. Mathematically equivalent to Fourier series expansions for periodic signals, PCE allows to characterize a random variable in terms of its PCE coefficients (aka Fourier coefficients). That is, the PCE of a random variable ",{"attributes":{},"tag":"math","children":["\\mathsf{x}"],"type":"node"}," is given by"],"type":"node"},{"attributes":{},"tag":"mathblock","children":["\\mathsf{x} = \\sum_{i=0}^L x_i \\phi_i,"],"type":"node"},{"attributes":{},"tag":"p","children":["where ",{"attributes":{},"tag":"math","children":["x_i"],"type":"node"}," are the so-called PCE coefficients, and ",{"attributes":{},"tag":"math","children":["\\phi_i"],"type":"node"}," are the orthogonal polynomials that are orthogonal relative to the probability density function of ",{"attributes":{},"tag":"math","children":["\\mathsf{x}"],"type":"node"},"."],"type":"node"},{"attributes":{},"tag":"p","children":["This tutorial walks you through the PCE of common random variables, namely Gaussian (",{"attributes":{},"tag":"code","children":["gaussian"],"type":"node"},"), Beta (",{"attributes":{},"tag":"code","children":["beta01"],"type":"node"},"), Uniform(",{"attributes":{},"tag":"code","children":["uniform01"],"type":"node"},"), Logistic (",{"attributes":{},"tag":"code","children":["logistic"],"type":"node"},"), and shows how they are implemented in ",{"attributes":{},"tag":"code","children":["PolyChaos"],"type":"node"},"."],"type":"node"},{"attributes":{},"tag":"h2","children":["Construction of Basis"],"type":"node"},{"attributes":{"lang":"@example mysetup"},"tag":"codeblock","children":["using PolyChaos\n"],"type":"node"},{"attributes":{},"tag":"p","children":["The orthogonal polynomials are constructed using the ",{"attributes":{},"tag":"code","children":["OrthoPoly"],"type":"node"},"-type (here of degree at most ",{"attributes":{},"tag":"code","children":["d"],"type":"node"},"). For canonical measures special constructors are implemented:"],"type":"node"},{"attributes":{"lang":"@example mysetup"},"tag":"codeblock","children":["d = 6\n\nmyops = Dict()\npolynames = [\"gaussian\", \"beta01\", \"uniform01\", \"logistic\"]\n\n# gaussian\ngaussian = GaussOrthoPoly(d);\nmyops[\"gaussian\"] = gaussian\n\n# beta01\nα, β = 1.3, 2.2\nbeta01 = Beta01OrthoPoly(d,α,β);\nmyops[\"beta01\"] = beta01\n\n# uniform01\nuniform01 = Uniform01OrthoPoly(d);\nmyops[\"uniform01\"] = uniform01\n\n# logistic\nlogistic = LogisticOrthoPoly(d);\nmyops[\"logistic\"] = logistic;\n\nmyops\n"],"type":"node"},{"attributes":{},"tag":"p","children":["For example, let's evaluate the Gaussian basis polynomials at some points"],"type":"node"},{"attributes":{"lang":"@example mysetup"},"tag":"codeblock","children":["points, degrees = randn(10), 0:2:d\n\n[ evaluate(degree,points,gaussian) for degree in degrees ]\n"],"type":"node"},{"attributes":{},"tag":"h2","children":["Finding PCE Coefficients"],"type":"node"},{"attributes":{},"tag":"p","children":["Having constructed the orthogonal bases, the question remains how to find the PCE coefficients for the common random variables. Every random variable can be characterized exactly by two PCE coefficients. For a Gaussian random variable, this is familiar: the mean and the variance suffice to describe a Gaussian random variable entirely. The same is true for any random variable of finite variance given the right basis. The function ",{"attributes":{},"tag":"code","children":["convert2affinePCE"],"type":"node"}," provides the first two PCE coefficients (hence the name affine) for the common random variables."],"type":"node"},{"attributes":{},"tag":"h3","children":["Gaussian"],"type":"node"},{"attributes":{},"tag":"p","children":["Given the Gaussian random variable ",{"attributes":{},"tag":"math","children":["\\mathsf{x} \\sim \\mathcal{N}(\\mu, \\sigma^2)"],"type":"node"}," with ",{"attributes":{},"tag":"math","children":["\\sigma > 0"],"type":"node"},", the affine PCE coefficients are"],"type":"node"},{"attributes":{"lang":"@example mysetup"},"tag":"codeblock","children":["# Gaussian\nμ, σ = 2., 0.2\npce_gaussian = convert2affinePCE(μ,σ,gaussian)\n"],"type":"node"},{"attributes":{},"tag":"h3","children":["Uniform"],"type":"node"},{"attributes":{},"tag":"p","children":["Given the uniform random variable ",{"attributes":{},"tag":"math","children":["\\mathsf{x} \\sim \\mathcal{U}(a, b)"],"type":"node"}," with finite support ",{"attributes":{},"tag":"math","children":["a<b"],"type":"node"},", the affine PCE coefficients are"],"type":"node"},{"attributes":{"lang":"@example mysetup"},"tag":"codeblock","children":["a, b = -0.3, 1.2\nconvert2affinePCE(a,b,uniform01)\n"],"type":"node"},{"attributes":{},"tag":"p","children":["Instead, if the expected value and standard deviation are known, the affine PCE coefficients of the uniform random variable are"],"type":"node"},{"attributes":{"lang":"@example mysetup"},"tag":"codeblock","children":["pce_uniform = convert2affinePCE(μ,σ,uniform01;kind=\"μσ\")\n# notice that the zero-order coefficient IS equivalent to the expected value μ\n"],"type":"node"},{"attributes":{},"tag":"h3","children":["Beta"],"type":"node"},{"attributes":{},"tag":"p","children":["Given the Beta random variable ",{"attributes":{},"tag":"math","children":["\\mathsf{x} \\sim \\mathcal{B}(a, b, \\alpha, \\beta)"],"type":"node"}," with finite support ",{"attributes":{},"tag":"math","children":["a<b"],"type":"node"}," and shape parameters ",{"attributes":{},"tag":"math","children":["\\alpha, \\beta > 0"],"type":"node"},", the affine PCE coefficients are"],"type":"node"},{"attributes":{"lang":"@example mysetup"},"tag":"codeblock","children":["convert2affinePCE(a,b,beta01)\n"],"type":"node"},{"attributes":{},"tag":"p","children":["Instead, if the expected value and standard deviation are known, the affine PCE coefficients of the uniform random variable are"],"type":"node"},{"attributes":{"lang":"@example mysetup"},"tag":"codeblock","children":["pce_beta = convert2affinePCE(μ,σ,beta01; kind=\"μσ\")\n"],"type":"node"},{"attributes":{},"tag":"h3","children":["Logistic"],"type":"node"},{"attributes":{},"tag":"p","children":["Given the logstic random variable ",{"attributes":{},"tag":"math","children":["\\mathsf{x} \\sim \\mathcal{L}(a_1,a_2)"],"type":"node"}," where ",{"attributes":{},"tag":"math","children":["a_2>0"],"type":"node"}," with the probability density function"],"type":"node"},{"attributes":{},"tag":"mathblock","children":["\\rho(t) = \\frac{1}{4 a_2} \\, \\operatorname{sech}^2 \\left(\\frac{t-a_1}{2a_2}\\right)"],"type":"node"},{"attributes":{},"tag":"p","children":["the affine PCE coefficients of the uniform random variable are"],"type":"node"},{"attributes":{"lang":"@example mysetup"},"tag":"codeblock","children":["a1, a2 = μ, sqrt(3)*σ/pi\npce_logistic = convert2affinePCE(a1,a2,logistic)\n"],"type":"node"},{"attributes":{},"tag":"h2","children":["Moments"],"type":"node"},{"attributes":{},"tag":"p","children":["It is a key feature of PCE to compute moments from the PCE coefficients alone; no sampling is required."],"type":"node"},{"attributes":{},"tag":"h3","children":["Gaussian"],"type":"node"},{"attributes":{"lang":"@example mysetup"},"tag":"codeblock","children":["mean(pce_gaussian,myops[\"gaussian\"]), std(pce_gaussian,myops[\"gaussian\"])\n"],"type":"node"},{"attributes":{},"tag":"h3","children":["Uniform"],"type":"node"},{"attributes":{"lang":"@example mysetup"},"tag":"codeblock","children":["mean(pce_uniform,myops[\"uniform01\"]), std(pce_uniform,myops[\"uniform01\"])\n"],"type":"node"},{"attributes":{},"tag":"h3","children":["Beta"],"type":"node"},{"attributes":{"lang":"@example mysetup"},"tag":"codeblock","children":["mean(pce_beta,myops[\"beta01\"]), std(pce_beta,myops[\"beta01\"])\n"],"type":"node"},{"attributes":{},"tag":"h3","children":["Logistic"],"type":"node"},{"attributes":{"lang":"@example mysetup"},"tag":"codeblock","children":["mean(pce_logistic,myops[\"logistic\"]), std(pce_logistic,myops[\"logistic\"])\n"],"type":"node"},{"attributes":{},"tag":"h2","children":["Sampling"],"type":"node"},{"attributes":{},"tag":"p","children":["Having found the PCE coefficients, it may be useful to sample the random variables. That means, find ",{"attributes":{},"tag":"math","children":["N"],"type":"node"}," realizations of the random variable that obey the random variable's probability density function. This is done in two steps:"],"type":"node"},{"attributes":{},"tag":"ol","children":[{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":["Draw ",{"attributes":{},"tag":"math","children":["N"],"type":"node"}," samples from the measure (",{"attributes":{},"tag":"code","children":["sampleMeasure()"],"type":"node"},"), and then"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":["Evaluate the basis polynomials and multiply times the PCE coefficients, i.e. ",{"attributes":{},"tag":"math","children":["\\sum_{i=0}^L x_i \\phi_i(\\xi_j)"],"type":"node"}," where ",{"attributes":{},"tag":"math","children":["\\xi_j"],"type":"node"}," is the ",{"attributes":{},"tag":"math","children":["j"],"type":"node"},"-th sample from the measure (",{"attributes":{},"tag":"code","children":["evaluatePCE()"],"type":"node"},")."],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"p","children":["Both steps are combined in the function ",{"attributes":{},"tag":"code","children":["samplePCE()"],"type":"node"},"."],"type":"node"},{"attributes":{},"tag":"h3","children":["Gaussian"],"type":"node"},{"attributes":{"lang":"@example mysetup"},"tag":"codeblock","children":["using Statistics\nN = 1000\nξ_gaussian = sampleMeasure(N,myops[\"gaussian\"])\nsamples_gaussian = evaluatePCE(pce_gaussian,ξ_gaussian,myops[\"gaussian\"])\n# samplePCE(N,pce_gaussian,myops[\"gaussian\"])\n"],"type":"node"},{"attributes":{},"tag":"h3","children":["Uniform"],"type":"node"},{"attributes":{"lang":"@example mysetup"},"tag":"codeblock","children":["ξ_uniform = sampleMeasure(N,myops[\"uniform01\"])\nsamples_uniform = evaluatePCE(pce_uniform,ξ_uniform,myops[\"uniform01\"])\n# samples_uniform = samplePCE(N,pce_uniform,myops[\"uniform01\"])\n"],"type":"node"},{"attributes":{},"tag":"h3","children":["Beta"],"type":"node"},{"attributes":{"lang":"@example mysetup"},"tag":"codeblock","children":["ξ_beta = sampleMeasure(N,myops[\"beta01\"])\nsamples_beta = evaluatePCE(pce_beta,ξ_beta,myops[\"beta01\"])\n# samples_beta = samplePCE(N,pce_beta,myops[\"beta01\"])\n"],"type":"node"},{"attributes":{},"tag":"h3","children":["Logistic"],"type":"node"},{"attributes":{"lang":"@example mysetup"},"tag":"codeblock","children":["ξ_logistic = sampleMeasure(N,myops[\"logistic\"])\nsamples_logistic = evaluatePCE(pce_logistic,ξ_logistic,myops[\"logistic\"])\n# samples_logistic = samplePCE(N,pce_logistic,myops[\"logistic\"])\n"],"type":"node"}],"type":"node"}],"type":"node"}